<!doctype html>

<html lang="ar" dir="rtl">  
<head>  
  <meta charset="UTF-8" />  
  <meta name="viewport" content="width=device-width,initial-scale=1" />  
  <title>she.store_dz</title>    <link rel="preconnect" href="https://fonts.googleapis.com">  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>  
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">    <style>  
    :root{  
      --pink:#d81b73;  
      --pinkLine:#f3c1d6;  
      --muted:#7a7a7a;  
      --bg:#ffffff;  
      --soft:#fff6fb;  
    }  
  
    *{box-sizing:border-box}  
    body{  
      margin:0;  
      font-family:"Tajawal", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;  
      background: var(--soft);  
      color:#000;  
    }  
  
    .wrap{  
      max-width: 460px;  
      margin: 0 auto;  
      padding: 10px 12px 14px;  
    }  
  
    .header{  
      background: linear-gradient(90deg,#ff6aa8,#ff3f90);  
      color:#fff;  
      text-align:center;  
      font-weight:900;  
      border-radius: 18px;  
      padding: 12px 10px;  
      font-size: 17px;  
      margin-bottom: 10px;  
    }  
  
    .box{  
      background: var(--bg);  
      border: 1px solid #ffd0e1;  
      border-radius: 16px;  
      padding: 10px;  
      margin-bottom: 10px;  
    }  
  
    .grid2{  
      display:grid;  
      grid-template-columns: 1fr 1fr;  
      gap: 10px;  
    }  
  
    label{  
      display:block;  
      color: #6f6f6f;  
      font-weight:700;  
      font-size: 13px;  
      margin-bottom: 6px;  
    }  
  
    input{  
      width:100%;  
      border: 1px solid #ffd0e1;  
      border-radius: 14px;  
      padding: 10px 10px;  
      font-size: 15px;  
      outline: none;  
      background:#fff;  
    }  
    input:focus{  
      border-color:#ff6aa8;  
      box-shadow: 0 0 0 3px rgba(255,106,168,.15);  
    }  
  
    /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ù€ Ø¯Ø¬ */  
    .resultBox{  
      margin-top: 10px;  
      background: linear-gradient(90deg,#f065a8,#d81b73);  
      border-radius: 16px;  
      padding: 10px 10px;  
      text-align:center;  
      color:#fff;  
    }  
    .dzd{  
      font-weight:900;  
      font-size: 22px;  
      line-height: 1.1;  
      margin:0;  
    }  
    .meaning{  
      margin:6px 0 0;  
      font-weight:900;  
      font-size: 18px; /* ÙƒØ¨ÙŠØ±Ø© ÙˆÙˆØ§Ø¶Ø­Ø© ÙƒÙŠÙ…Ø§ Ø·Ù„Ø¨ØªÙŠ */  
    }  
    .after{  
      text-align:center;  
      margin-top:8px;  
      color: var(--pink);  
      font-weight:900;  
      font-size: 14px;  
    }  
  
    /* ====== Ø§Ù„ÙØ§ØªÙˆØ±Ø© (Ù†ÙØ³ Ø´ÙƒÙ„ Ø§Ù„ØµÙˆØ±Ø©) ====== */  
    .invoice{  
      background:#fff;  
      border: 1px solid #ffd0e1;  
      border-radius: 16px;  
      padding: 10px 12px;  
    }  
  
    .invoiceTop{  
      display:flex;  
      justify-content:space-between;  
      align-items:flex-start;  
      gap: 10px;  
      margin-bottom: 6px;  
      font-size: 12px;  
      color:#666;  
      font-weight:700;  
    }  
    .invoiceTop .right,  
    .invoiceTop .left{  
      line-height:1.35;  
    }  
  
    .line{  
      display:flex;  
      justify-content:space-between;  
      align-items:center;  
      padding: 10px 0;             /* ØµØºÙ‘Ø±Ù†Ø§Ù‡Ø§ */  
      border-bottom: 2px solid var(--pinkLine);  
    }  
    .label{  
      color: var(--muted);  
      font-weight:700;  
      font-size: 18px;            /* ÙƒÙŠÙ…Ø§ Ø§Ù„ØµÙˆØ±Ø© */  
    }  
    .value{  
      color:#000;  
      font-weight:900;  
      font-size: 20px;            /* ÙƒÙŠÙ…Ø§ Ø§Ù„ØµÙˆØ±Ø© */  
      text-align:left;  
      direction:ltr;              /* Ù„Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ø±Ù‚Ù… */  
    }  
    .value.ar{  
      direction:rtl;  
      text-align:right;  
    }  
    .total .value{  
      font-size: 22px;  
    }  
  
    .thanks{  
      text-align:center;  
      margin-top: 12px;  
      font-size: 22px;            /* Ù…Ø§Ø´ÙŠ ÙƒØ¨Ø§Ø± Ø¨Ø²Ø§Ù */  
      font-weight:900;  
      color: var(--pink);  
    }  
    .note{  
      text-align:center;  
      margin-top: 8px;  
      font-size: 16px;  
      font-weight:700;  
      color: #8b2d57;  
      line-height:1.5;  
    }  
  
    .actions{  
      display:flex;  
      gap: 10px;  
      margin-top: 10px;  
    }  
    button{  
      flex:1;  
      border:none;  
      border-radius: 14px;  
      padding: 10px 10px;  
      font-weight:900;  
      font-size: 14px;  
      cursor:pointer;  
    }  
    .btnDownload{  
      background: linear-gradient(90deg,#ff6aa8,#ff3f90);  
      color:#fff;  
    }  
    .btnClear{  
      background:#fff;  
      border: 1px solid #ffb7d1;  
      color: var(--pink);  
    }  
  
    /* Ù†Ø®Ù„ÙŠ Ø§Ù„ØµÙØ­Ø© Ù…Ø§ ØªÙˆÙ„Ù‘ÙŠØ´ Ø·ÙˆÙŠÙ„Ø© Ø¨Ø²Ø§Ù */  
    .tight{ margin-top: 8px; }  
  </style>  </head>  <body>  
  <div class="wrap">  
    <div class="header">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ ÙÙŠ she.store_dz</div>  <!-- Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ (ÙˆØ§Ø¬Ø¯Ø© 1 Ùˆ 1) -->  
<div class="box">  
  <div class="grid2">  
    <div>  
      <label for="products">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬</label>  
      <input id="products" inputmode="numeric" value="1" />  
    </div>  
    <div>  
      <label for="pieces">Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø·Ø¹</label>  
      <input id="pieces" inputmode="numeric" value="1" />  
    </div>  
  </div>  

  <div class="tight">  
    <label for="usd">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± ($)</label>  
    <input id="usd" inputmode="decimal" value="" />  
  </div>  

  <div class="resultBox" aria-live="polite">  
    <p class="dzd" id="dzdText">0 Ø¯Ø¬</p>  
    <p class="meaning" id="meaningText">ÙŠØ¹Ù†ÙŠ: 0 Ø£Ù„Ù</p>  
  </div>  

  <div class="after">Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ ÙŠØ§ Ø³ÙƒØ±Ø© Ù„Ø²ÙŠØ§Ø±ØªÙƒ ğŸ’—</div>  
</div>  

<!-- Ø§Ù„ÙØ§ØªÙˆØ±Ø© (ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· + ØªÙ†Ø²ÙŠÙ„ ØµÙˆØ±Ø©) -->  
<div class="invoice" id="invoiceCard">  

  <div class="invoiceTop">  
    <div class="right" id="invMetaR">Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©: -</div>  
    <div class="left" id="invMetaL">Ø§Ù„ØªØ§Ø±ÙŠØ®: -<br>Ø§Ù„ÙˆÙ‚Øª: -</div>  
  </div>  

  <!-- (Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ÙÙˆÙ‚ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨Ø§Ø´ Ù…Ø§ Ù†Ø·ÙˆÙ‘Ù„ÙˆØ´ Ø¨Ø²Ø§Ù) -->  
  <div class="box" style="margin:0 0 10px 0; padding:10px; border-radius:14px;">  
    <div style="display:grid; gap:10px">  
      <div>  
        <label for="fullName">Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù„Ù‚Ø¨ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ)</label>  
        <input id="fullName" />  
      </div>  
      <div>  
        <label for="address">Ø§Ù„Ø³ÙƒÙ† (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ)</label>  
        <input id="address" />  
      </div>  
      <div>  
        <label for="phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ)</label>  
        <input id="phone" inputmode="tel" />  
      </div>  
    </div>  
  </div>  

  <!-- Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠØªØµÙˆÙ‘Ø± ÙˆÙŠØªÙ†Ø²Ù‘Ù„ ÙƒØµÙˆØ±Ø© -->  
  <div id="invoiceShot">  
    <div class="line">  
      <div class="value ar" id="invName">-</div>  
      <div class="label">Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù„Ù‚Ø¨</div>  
    </div>  

    <div class="line">  
      <div class="value ar" id="invAddr">-</div>  
      <div class="label">Ø§Ù„Ø³ÙƒÙ†</div>  
    </div>  

    <div class="line">  
      <div class="value" id="invPhone">-</div>  
      <div class="label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</div>  
    </div>  

    <div class="line">  
      <div class="value" id="invProducts">1</div>  
      <div class="label">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>  
    </div>  

    <div class="line total">  
      <div class="value" id="invTotal">0 Ø¯Ø¬</div>  
      <div class="label">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</div>  
    </div>  

    <div class="thanks" id="thankLine">Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ ğŸ’—</div>  

    <div class="note">  
      Ø¹Ù†Ø¯ Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ù„Ù„Ø´Ø±Ø§Ø¡ Ø§Ø±Ø³Ù„ÙŠ Ø±Ø§Ø¨Ø· Ø³Ù„Ø© Ù…Ø¹ ØµÙˆØ±Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙÙŠ Ø§Ù„Ø®Ø§Øµ âœ…ğŸ“±  
    </div>  
  </div>  

  <div class="actions">  
    <button class="btnDownload" id="downloadBtn" type="button">ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© (ØµÙˆØ±Ø©)</button>  
    <button class="btnClear" id="clearBtn" type="button">Ù…Ø³Ø­</button>  
  </div>  
</div>

  </div>    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>    <script>  
    // Ø§Ù„Ù‚ÙŠÙ… Ù…Ø®ÙÙŠØ© (Ù…Ø§ Ù†ÙƒØªØ¨Ù‡Ù…Ø´ ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙƒÙŠÙ…Ø§ Ø·Ù„Ø¨ØªÙŠ)  
    const USD_TO_DZD = 270;  
    const PROFIT_PER_PRODUCT = 250;  
    const PACKAGING_FEE = 50;  
  
    // Ø£Ø¶ÙÙ†Ø§ Ø¹ÙˆØ§Ø·Ù  
    const nickMap = new Map([  
      ["Ø±Ø­Ø§Ø¨","Ø±Ø­ÙˆØ¨Ø©"],  
      ["ÙØ±Ø­","ÙØ±ÙØ±"],  
      ["Ø³Ù†Ø¯Ø³","Ø³ÙˆØ³Ùˆ"],  
      ["Ø§Ù…Ø§Ù„","Ø§Ù…ÙˆÙ„Ø©"],  
      ["Ù‡Ù†Ø§Ø¯ÙŠ","Ù‡Ù†ÙˆØ¯Ø©"],  
      ["Ø§ÙŠØ©","Ø§ÙŠÙˆØªØ©"], ["Ø¢ÙŠØ©","Ø§ÙŠÙˆØªØ©"],  
      ["Ø®Ù„ÙŠØµØ©","Ø®Ù„ÙˆØµØ©"],  
      ["ØªÙ‚ÙˆÙ‰","ØªÙ‚Ùˆ"],  
      ["Ø§ÙƒØ±Ø§Ù…","ÙƒØ±ÙˆÙ…"], ["Ø¥ÙƒØ±Ø§Ù…","ÙƒØ±ÙˆÙ…"],  
      ["Ø¶Ø­Ù‰","Ø¶Ø­Ùˆ"],  
      ["Ø±Ø­Ù…Ø©","Ø±Ø­ÙˆÙ…Ø©"],  
      ["Ø´ÙŠÙ…Ø§Ø¡","Ø´ÙŠÙ…Ùˆ"],  
      ["Ø§Ø´ÙˆØ§Ù‚","Ø´ÙˆØ´Ùˆ"], ["Ø£Ø´ÙˆØ§Ù‚","Ø´ÙˆØ´Ùˆ"],  
      ["Ø¯Ø¹Ø§Ø¡","Ø¯Ø¹Ø¯Ø¹"],  
      ["Ø¨Ø³Ù…Ù„Ø©","Ø¨Ø³ÙˆÙ…Ø©"],  
      ["Ø³Ù„Ù…Ù‰","Ø³Ù„Ù…ÙˆØ´"],  
      ["Ù„Ø¨Ù†Ù‰","Ù„Ø¨Ù†Ø§ØªÙŠ"],  
      ["Ø§Ø³Ø±Ø§Ø¡","Ø§ÙŠØ³Ø±ÙŠ"], ["Ø¥Ø³Ø±Ø§Ø¡","Ø§ÙŠØ³Ø±ÙŠ"],  
      ["Ø¨ØªÙˆÙ„","Ø¨ØªÙˆÙ„ÙŠ"],  
      ["Ø±ÙˆÙ…ÙŠØ³Ø©","Ø±ÙˆÙ…ÙŠ"],  
      ["Ø§ÙŠÙ…Ø§Ù†","Ø§Ù…ÙˆÙ†Ø©"], ["Ø¥ÙŠÙ…Ø§Ù†","Ø§Ù…ÙˆÙ†Ø©"],  
      ["Ø­Ù†ÙŠÙ†","Ø­Ù†ÙˆÙ†"],  
      ["Ø±ÙˆÙŠØ¯Ø©","Ø±ÙˆØ±Ùˆ"],  
      ["Ù‡Ø¯ÙŠÙ„","Ù‡Ø¯ÙˆÙ„Ø©"],  
      ["ÙƒÙ†Ø¯Ø©","ÙƒÙ†Ø¯ÙˆØ´"],  
      ["Ø§Ø±ÙŠØ¬","Ø¬ÙˆØ¬Ø§"], ["Ø£Ø±ÙŠØ¬","Ø¬ÙˆØ¬Ø§"],  
      ["Ø§Ù…ÙŠÙ†Ø©","Ø§Ù…ÙŠÙ†Ùˆ"], ["Ø£Ù…ÙŠÙ†Ø©","Ø§Ù…ÙŠÙ†Ùˆ"],  
      ["ØµÙˆÙ†ÙŠØ§","ØµÙ†ØµÙ†"],  
      ["Ø³Ø¹Ø§Ø¯","Ø³ÙˆØ³Ùˆ"],  
      ["Ù…Ø±ÙˆÙ‰","Ù…ÙŠÙ…ÙŠ"],  
      ["Ù…Ø±ÙŠÙ…","Ù…Ø±ÙŠÙˆÙ…Ø©"],  
      ["Ø¬Ù‡Ø§Ø¯","Ø¬Ù‡ÙˆØ¯Ø©"],  
      ["Ù†Ø³Ø±ÙŠÙ†","Ù†Ø³Ø±ÙŠÙ†Ø©"],  
      ["Ù†Ø¯Ù‰","Ù†Ø¯ÙˆØ´"],  
      ["Ù…Ù†Ø©","Ù…Ù†ÙˆØ´"],  
      ["ÙØªÙŠØ­Ø©","ÙØªÙˆØ­"],  
      ["Ø§Ø³ÙŠÙ„","Ø§Ø³ÙˆÙ„Ø©"], ["Ø£Ø³ÙŠÙ„","Ø§Ø³ÙˆÙ„Ø©"],  
      ["ÙˆØ±Ø¯Ø©","ÙˆØ±Ø¯ÙˆØ´"],  
      ["ÙˆØ¦Ø§Ù…","ÙˆØ¦ÙˆÙ…"],  
      ["ÙˆØµØ§Ù„","ÙˆØµÙˆÙ„"],  
      ["Ø§ÙŠÙ†Ø§Ø³","Ø§Ù†ÙˆØ³Ø©"], ["Ø¥ÙŠÙ†Ø§Ø³","Ø§Ù†ÙˆØ³Ø©"],  
      ["Ù…Ø±Ø§Ù…","Ù…Ø±ÙˆØ´"],  
      ["Ø¹ÙˆØ§Ø·Ù","Ø¹Ø·ÙˆÙØªÙŠ"]  
    ]);  
  
    const elProducts = document.getElementById("products");  
    const elPieces   = document.getElementById("pieces"); // Ù…Ø§ ÙŠØ¯Ø®Ù„Ø´ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨  
    const elUsd      = document.getElementById("usd");  
  
    const dzdText = document.getElementById("dzdText");  
    const meaningText = document.getElementById("meaningText");  
  
    const fullName = document.getElementById("fullName");  
    const address  = document.getElementById("address");  
    const phone    = document.getElementById("phone");  
  
    const invName = document.getElementById("invName");  
    const invAddr = document.getElementById("invAddr");  
    const invPhone = document.getElementById("invPhone");  
    const invProducts = document.getElementById("invProducts");  
    const invTotal = document.getElementById("invTotal");  
    const thankLine = document.getElementById("thankLine");  
  
    const invMetaR = document.getElementById("invMetaR");  
    const invMetaL = document.getElementById("invMetaL");  
  
    const clearBtn = document.getElementById("clearBtn");  
    const downloadBtn = document.getElementById("downloadBtn");  
  
    function toNumber(val){  
      if(!val) return 0;  
      val = String(val).replace(",", ".").replace(/[^\d.]/g, "");  
      const n = parseFloat(val);  
      return Number.isFinite(n) ? n : 0;  
    }  
  
    function toInt(val){  
      if(!val) return 0;  
      val = String(val).replace(/[^\d]/g, "");  
      const n = parseInt(val, 10);  
      return Number.isFinite(n) ? n : 0;  
    }  
  
    // âœ… Ø¨Ù„Ø§ ÙÙˆØ§ØµÙ„  
    function formatDZD(n){  
      const x = Math.max(0, Math.round(n));  
      return String(x) + " Ø¯Ø¬";  
    }  
  
    // âœ… ÙŠØ¹Ù†ÙŠ Ø¨Ø§Ù„ÙØ±Ù†Ùƒ: 1 Ø¯Ø¬ = 100 ÙØ±Ù†Ùƒ  
    // 10000Ø¯Ø¬ => 1,000,000 ÙØ±Ù†Ùƒ => Ù…Ù„ÙŠÙˆÙ†  
    function formatMeaningByFranc(nDzd){  
      const dzd = Math.max(0, Math.round(nDzd));  
      const francs = dzd * 100;  
  
      const millions = Math.floor(francs / 1000000);  
      const rest = francs % 1000000;  
      const thousands = Math.floor(rest / 1000); // Ø¨Ø§Ù„Ø£Ù„Ù ÙØ±Ù†Ùƒ  
  
      let millionText = "";  
      if (millions === 0){  
        // Ù…Ø«Ø§Ù„ 300Ø¯Ø¬ => 30 Ø£Ù„Ù  
        return "ÙŠØ¹Ù†ÙŠ: " + String(thousands) + " Ø£Ù„Ù";  
      }  
  
      if (millions === 1) millionText = "Ù…Ù„ÙŠÙˆÙ†";  
      else if (millions === 2) millionText = "Ø²ÙˆØ¬ Ù…Ù„Ø§ÙŠÙ†";  
      else millionText = String(millions) + " Ù…Ù„Ø§ÙŠÙ†";  
  
      if (thousands > 0){  
        return "ÙŠØ¹Ù†ÙŠ: " + millionText + " Ùˆ" + String(thousands) + " Ø£Ù„Ù";  
      }  
      return "ÙŠØ¹Ù†ÙŠ: " + millionText;  
    }  
  
    function normalizeName(s){  
      return (s || "").trim().replace(/Ù€/g, "").replace(/\s+/g, " ");  
    }  
  
    function firstNameFromFull(full){  
      const t = normalizeName(full);  
      if(!t) return "";  
      return t.split(" ")[0];  
    }  
  
    // fallback: Ø­Ø±ÙÙŠÙ† + "ÙˆØ´"  
    function fallbackNickname(firstName){  
      const n = normalizeName(firstName);  
      if(!n) return "";  
      const two = n.slice(0, 2);  
      return two + "ÙˆØ´";  
    }  
  
    function getNickname(full){  
      const first = firstNameFromFull(full);  
      if(!first) return "";  
      if(nickMap.has(first)) return nickMap.get(first);  
      return fallbackNickname(first);  
    }  
  
    function calcTotalDZD(){  
      const p = Math.max(1, toInt(elProducts.value));  
      const usd = toNumber(elUsd.value);  
      const total = (usd * USD_TO_DZD) + (p * PROFIT_PER_PRODUCT) + PACKAGING_FEE;  
      return Math.max(0, Math.round(total));  
    }  
  
    function pad2(x){ return String(x).padStart(2,"0"); }  
  
    function updateMeta(){  
      const now = new Date();  
      const y = now.getFullYear();  
      const m = pad2(now.getMonth()+1);  
      const d = pad2(now.getDate());  
      const hh = pad2(now.getHours());  
      const mm = pad2(now.getMinutes());  
  
      // Ø±Ù‚Ù… ÙØ§ØªÙˆØ±Ø© Ø¨Ø³ÙŠØ· Ù…Ù† Ø§Ù„ÙˆÙ‚Øª (Ø¨Ø¯ÙˆÙ† Ø®ØªÙ…)  
      const invNo = "SHE-" + String(now.getTime()).slice(-6);  
  
      invMetaR.textContent = "Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©: " + invNo;  
      invMetaL.innerHTML = "Ø§Ù„ØªØ§Ø±ÙŠØ®: " + `${y}-${m}-${d}` + "<br>" + "Ø§Ù„ÙˆÙ‚Øª: " + `${hh}:${mm}`;  
    }  
  
    function updateUI(){  
      const p = Math.max(1, toInt(elProducts.value));  
      const totalDzd = calcTotalDZD();  
  
      dzdText.textContent = formatDZD(totalDzd);  
      meaningText.textContent = formatMeaningByFranc(totalDzd);  
  
      invName.textContent = normalizeName(fullName.value) || "-";  
      invAddr.textContent = normalizeName(address.value) || "-";  
      invPhone.textContent = normalizeName(phone.value) || "-";  
      invProducts.textContent = String(p);  
      invTotal.textContent = formatDZD(totalDzd);  
  
      const n = normalizeName(fullName.value);  
      if(n){  
        const nick = getNickname(n);  
        thankLine.textContent = "Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ " + nick + " ğŸ’—";  
      }else{  
        thankLine.textContent = "Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ ğŸ’—";  
      }  
    }  
  
    let rafId = null;  
    function scheduleUpdate(){  
      if(rafId) cancelAnimationFrame(rafId);  
      rafId = requestAnimationFrame(()=>{  
        rafId = null;  
        updateMeta();  
        updateUI();  
      });  
    }  
  
    ["input","change","keyup"].forEach(evt=>{  
      elProducts.addEventListener(evt, scheduleUpdate);  
      elUsd.addEventListener(evt, scheduleUpdate);  
      elPieces.addEventListener(evt, scheduleUpdate); // Ù„Ù„ØªØºÙŠÙŠØ± ÙÙ‚Ø·  
      fullName.addEventListener(evt, scheduleUpdate);  
      address.addEventListener(evt, scheduleUpdate);  
      phone.addEventListener(evt, scheduleUpdate);  
    });  
  
    clearBtn.addEventListener("click", ()=>{  
      elProducts.value = "1";  
      elPieces.value = "1";  
      elUsd.value = "";  
      fullName.value = "";  
      address.value = "";  
      phone.value = "";  
      scheduleUpdate();  
      window.scrollTo({top:0, behavior:"smooth"});  
    });  
  
    downloadBtn.addEventListener("click", async ()=>{  
      const n = normalizeName(fullName.value);  
      const a = normalizeName(address.value);  
      const ph = normalizeName(phone.value);  
  
      if(!n || !a || !ph){  
        alert("Ù„Ø§Ø²Ù… ØªØ¹Ù…Ù‘Ø±ÙŠ: Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù„Ù‚Ø¨ + Ø§Ù„Ø³ÙƒÙ† + Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ");  
        return;  
      }  
  
      const node = document.getElementById("invoiceShot");  
      const canvas = await html2canvas(node, {  
        backgroundColor: "#ffffff",  
        scale: 2,  
        useCORS: true  
      });  
  
      const link = document.createElement("a");  
      link.download = "ÙØ§ØªÙˆØ±Ø©_she.store_dz.png";  
      link.href = canvas.toDataURL("image/png");  
      link.click();  
    });  
  
    // ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ  
    updateMeta();  
    updateUI();  
  
// ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹  
setInterval(() => {  
  updateMeta();  
}, 60000); // ÙƒÙ„ 60 Ø«Ø§Ù†ÙŠØ©  
  </script>  </body>  
  </html>
